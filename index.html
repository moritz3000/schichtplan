<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <!-- Kein Zoomen: mobile Web-App -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Goethebunker Schichtplanung - Übersicht</title>

  <style>
    :root {
      --primary-color: #007bff;
      --secondary-color: #6c757d;
      --danger-color: #dc3545;
      --background-color: #f5f5f5;
      --white: #ffffff;
      --font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      --border-radius: 8px;
      --shadow: 0 4px 6px rgba(0,0,0,0.1);
      --button-padding: 8px 12px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: var(--font-family);
      background-color: var(--background-color);
      color: #333;
      padding-bottom: 60px;
      margin: 0;
    }

    header {
      background-color: var(--primary-color);
      color: var(--white);
      padding: 0 15px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: 1.4em;
      box-shadow: var(--shadow);
    }
    .title {
      font-weight: bold;
      font-size: 1.2em;
    }
    #welcomeUser {
      font-size: 1em;
      margin-right: 10px;
    }

    .container {
      max-width: 800px;
      margin: auto;
      padding: 20px;
    }

    label {
      display: block;
      margin-bottom: 8px;
      font-weight: bold;
    }

    input, select {
      width: 100%;
      padding: 12px;
      margin-bottom: 16px;
      border: 1px solid #ccc;
      border-radius: var(--border-radius);
      font-size: 1em;
    }

    button {
      padding: var(--button-padding);
      background-color: var(--primary-color);
      color: var(--white);
      border: none;
      border-radius: var(--border-radius);
      cursor: pointer;
      font-size: 1em;
      margin-bottom: 16px;
    }

    .event {
      background-color: var(--white);
      border: 1px solid #ddd;
      border-radius: var(--border-radius);
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: var(--shadow);
      position: relative;
    }
    .event h3 {
      margin: 0 0 8px;
      color: var(--primary-color);
    }

    .availability {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 10px;
    }
    .name-item {
      background-color: #e9ecef;
      padding: 6px 10px;
      border-radius: var(--border-radius);
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 0.9em;
      margin-bottom: 6px;
    }
    .name-item .remove {
      background-color: var(--danger-color);
      color: #fff;
      border: none;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      font-size: 0.8em;
      cursor: pointer;
    }

    #adminSection {
      display: none;
      margin-top: 40px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 16px;
    }
    table, th, td {
      border: 1px solid #ddd;
    }
    th, td {
      padding: 12px;
      font-size: 1em;
      text-align: left;
    }
    th {
      background-color: #f2f2f2;
      color: #333;
    }

    footer {
      background-color: var(--secondary-color);
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 8px;
      box-shadow: 0 -2px 6px rgba(0,0,0,0.1);
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
    }
    #logoutButton {
      background-color: var(--danger-color);
      color: #fff;
      border: none;
      border-radius: 4px;
      padding: 6px 12px;
      cursor: pointer;
      display: none;
      font-size: 0.9em;
    }

    #notification {
      position: fixed;
      top: 10px;
      right: 10px;
      z-index: 2000;
      max-width: 90%;
    }
    .notification-message {
      background-color: #28a745;
      color: #fff;
      padding: 10px 20px;
      margin-bottom: 10px;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      opacity: 0.95;
    }
    .notification-error {
      background-color: #dc3545;
    }
    .notification-info {
      background-color: #17a2b8;
    }

    @media (max-width: 768px) {
      .event {
        padding: 16px;
      }
      button {
        font-size: 1em;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="title">Goethebunker Schichtplanung</div>
    <div id="welcomeUser" style="display:none;">Willkommen!</div>
  </header>

  <div id="notification"></div>

  <div class="container">
    <p id="currentDate" style="font-size: 1.1em; margin-bottom: 20px;"></p>

    <!-- Login/Register-Bereich -->
    <div id="authSection">
      <h3>Einloggen</h3>
      <label for="emailInput">E-Mail:</label>
      <input type="email" id="emailInput" placeholder="E-Mail eingeben">

      <label for="passwordLogin">Passwort:</label>
      <input type="password" id="passwordLogin" placeholder="Passwort eingeben">

      <div style="margin-bottom:16px;">
        <input type="checkbox" id="staySignedIn" />
        <label for="staySignedIn" style="font-weight:normal;">Angemeldet bleiben</label>
      </div>

      <button id="loginButton">Einloggen</button>
      <hr />

      <h4>Oder registrieren</h4>
      <label for="usernameRegister">Benutzername:</label>
      <input type="text" id="usernameRegister" placeholder="Dein gewünschter Name">

      <label for="emailRegister">E-Mail:</label>
      <input type="email" id="emailRegister" placeholder="E-Mail eingeben">

      <label for="passwordRegister">Passwort:</label>
      <input type="password" id="passwordRegister" placeholder="Passwort eingeben">

      <button id="registerButton">Registrieren</button>
    </div>

    <!-- Admin: Neues Event hinzufügen -->
    <form id="eventForm" style="display: none;">
      <h3>Neues Event hinzufügen</h3>
      <label for="eventName">Event Name:</label>
      <select id="eventName" onchange="toggleOtherEvent()">
        <option value="">-- Wähle ein Event --</option>
        <option value="Bunkernacht">Bunkernacht</option>
        <option value="Pferdreht">Pferdreht</option>
        <option value="IDOLS">IDOLS</option>
        <option value="Baracke">Baracke</option>
        <option value="Crypt">Crypt</option>
        <option value="Dancehall Station">Dancehall Station</option>
        <option value="LOL">LOL</option>
        <option value="sonstige">Sonstige</option>
      </select>

      <div id="otherEventContainer" style="display:none;">
        <label for="otherEvent">Sonstiges Event:</label>
        <input type="text" id="otherEvent" />
      </div>

      <div style="display:flex; gap:20px;">
        <div style="flex:1;">
          <label for="eventDate">Datum:</label>
          <input type="date" id="eventDate">
        </div>
        <div style="flex:1;">
          <label for="eventTime">Startzeit:</label>
          <input type="time" id="eventTime">
        </div>
      </div>

      <button type="button" onclick="addEvent()">Event hinzufügen</button>
      <hr/>
    </form>

    <!-- Event-Übersicht -->
    <div id="eventContainer"></div>

    <!-- Admin-Bereich: Verfügbarkeits-Tabelle -->
    <div id="adminSection">
      <h3>Verfügbarkeits-Tabelle (nur Admin)</h3>
      <table>
        <thead>
          <tr>
            <th>Datum</th>
            <th>Event</th>
            <th>Theke</th>
            <th>Garderobe</th>
            <th>Tür</th>
            <th>Kasse</th>
            <th>Schichtleitung</th>
          </tr>
        </thead>
        <tbody id="availabilityTable"></tbody>
      </table>
      <button type="button" onclick="exportCSV()">Als CSV exportieren</button>
      <!-- Admin: Link zu adminUsers.html -->
      <button id="manageUsersBtn" style="display:none;">Mitarbeiter verwalten</button>
    </div>
  </div>

  <footer>
    <button id="logoutButton">Logout</button>
  </footer>

  <!-- Firebase + JS -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.2.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.2.0/firebase-analytics.js";
    import {
      getFirestore, collection, doc, getDocs, onSnapshot, addDoc, updateDoc, deleteDoc,
      query, where, arrayUnion, arrayRemove
    } from "https://www.gstatic.com/firebasejs/11.2.0/firebase-firestore.js";
    import {
      getAuth, onAuthStateChanged, setPersistence, browserLocalPersistence,
      browserSessionPersistence, signInWithEmailAndPassword,
      createUserWithEmailAndPassword, updateProfile, signOut
    } from "https://www.gstatic.com/firebasejs/11.2.0/firebase-auth.js";

    // Deine Firebase-Konfiguration:
const firebaseConfig = {
  apiKey: "AIzaSyADch6nVtF-ljkPWvsae-rHEaiuKJSswY0",
  authDomain: "schichtplan-5c70f.firebaseapp.com",
  projectId: "schichtplan-5c70f",
  storageBucket: "schichtplan-5c70f.firebasestorage.app",
  messagingSenderId: "502149312331",
  appId: "1:502149312331:web:1dbce2d7fa034f25d702ce",
  measurementId: "G-0DL0R5B7LV"
};
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const db = getFirestore(app);
    const auth = getAuth(app);

    let loggedInUser = null;
    let canRemove = false;

    // ----------------------------
    // ARRAYS + KONSTANTEN
    // ----------------------------
    let allUsers = [];
    let allEvents = [];
    const POSITIONS = ["Theke","Garderobe","Tür","Kasse","Schichtleitung"];

    // ----------------------------
    // NOTIFICATION
    // ----------------------------
    function showNotification(msg, type='success'){
      const container= document.getElementById('notification');
      const div= document.createElement('div');
      div.className='notification-message';
      if(type==='error') div.classList.add('notification-error');
      else if(type==='info') div.classList.add('notification-info');
      div.textContent= msg;
      container.appendChild(div);
      setTimeout(()=>{
        div.style.opacity='0';
        setTimeout(()=>div.remove(),500);
      },3000);
    }

    // ----------------------------
    // DATUM
    // ----------------------------
    function setCurrentDate(){
      const el= document.getElementById('currentDate');
      const d= new Date();
      const opts= { day:'2-digit', month:'2-digit', year:'numeric', weekday:'long' };
      el.textContent= d.toLocaleDateString('de-DE', opts);
    }

    // ----------------------------
    // LOAD ALL USERS
    // ----------------------------
    async function loadAllUsers(){
      allUsers=[];
      const snap= await getDocs(collection(db,"users"));
      snap.forEach(docSnap=>{
        const data= docSnap.data();
        // Spread ersetzen => Object.assign
        const combined= Object.assign({ id: docSnap.id }, data);
        allUsers.push(combined);
      });
      console.log("[loadAllUsers]", allUsers.length, "Users gefunden.");
    }

    // ----------------------------
    // HÖRE PER onSnapshot AUF EVENTS
    // ----------------------------
    function listenToEvents(){
      onSnapshot(collection(db,"events"), (snapshot)=>{
        allEvents=[];
        snapshot.forEach(docSnap=>{
          const data= docSnap.data();
          const combined= Object.assign({id: docSnap.id}, data);
          allEvents.push(combined);
        });
        console.log("[listenToEvents]", allEvents.length, "Events.");

        // Admin-tabelle & normale Eventliste
        renderAdminTable(allEvents, allUsers);
        renderEvents(allEvents);
      },(err)=>{
        console.error("Fehler events:", err);
        showNotification("Fehler events: "+err.message,'error');
      });
    }

    // ----------------------------
    // RENDER ADMIN TABELLE
    // ----------------------------
function renderAdminTable(events, users) {
  const tbody = document.getElementById('availabilityTable');
  tbody.innerHTML = '';

  events.forEach(ev => {
    // Neue Zeile pro Event
    const tr = document.createElement('tr');

    // (1) Datum
    const dObj = new Date(ev.datum);
    const dStr = dObj.toLocaleDateString('de-DE',{day:'2-digit',month:'2-digit',year:'numeric',weekday:'long'});
    const tdDate = document.createElement('td');
    tdDate.textContent = dStr;
    tr.appendChild(tdDate);

    // (2) Event-Name
    const tdEvent = document.createElement('td');
    tdEvent.textContent = ev.name;
    tr.appendChild(tdEvent);

    // (3..) Spalten je Rolle
    POSITIONS.forEach(role => {
      const td = document.createElement('td');

      // 3.1) Zeige, wer schon in ev.mitarbeiterByRole[role] ist
      const namesArr = ev.mitarbeiterByRole && ev.mitarbeiterByRole[role] 
                       ? ev.mitarbeiterByRole[role] 
                       : [];
      if (namesArr.length > 0) {
        const listP = document.createElement('p');
        listP.textContent = namesArr.join(", ");
        td.appendChild(listP);
      }

      // 3.2) Wenn Admin: Dropdown + Button
      if (canRemove) {
        // Dropdown aller Users
        const select = document.createElement('select');
        // optional: leere Option
        const optEmpty = document.createElement('option');
        optEmpty.value = "";
        optEmpty.textContent = "-- Mitarbeiter wählen --";
        select.appendChild(optEmpty);

        users.forEach(u => {
          // Du kannst filtern, ob u ev. eine spezielle Rolle hat usw.
          // Hier fügen wir alle ein:
          const opt = document.createElement('option');
          opt.value = u.email;
          opt.textContent = u.email; // oder u.displayName
          select.appendChild(opt);
        });
        td.appendChild(select);

        // Hinzufügen-Button
        const addBtn = document.createElement('button');
        addBtn.textContent = "Hinzufügen";
        addBtn.style.marginLeft = "8px";
        addBtn.onclick = () => {
          const chosenEmail = select.value;
          if (!chosenEmail) return;
          addUserToRole(ev.id, role, chosenEmail);
        };
        td.appendChild(addBtn);
      }

      tr.appendChild(td);
    });

    tbody.appendChild(tr);
  });
}
async function addUserToRole(eventId, role, email) {
  if(!canRemove) return;
  try {
    const ref = doc(db, "events", eventId);
    // z.B. "mitarbeiterByRole.Theke"
    const fieldPath = "mitarbeiterByRole." + role;
    await updateDoc(ref, {
      [fieldPath]: arrayUnion(email)
    });
    showNotification(`Mitarbeiter ${email} zur Rolle ${role} hinzugefügt.`,'info');
  } catch(err) {
    console.error("Fehler addUserToRole:", err);
    showNotification("Fehler addUserToRole: "+err.message,'error');
  }
}

async function addEvent() {
  if(!canRemove){
    showNotification('Nur Admin kann Events anlegen','error');
    return;
  }
  const eventNameVal = document.getElementById('eventName').value.trim();
  // ...
  try {
    await addDoc(collection(db,"events"), {
      datum: eventDate,
      name: eventNameVal,
      startzeit: eventTime,
      // NEU: init
      mitarbeiterByRole: {
        Theke: [],
        Garderobe: [],
        Tür: [],
        Kasse: [],
        Schichtleitung: []
      },
      // ...
    });
    showNotification("Event hinzugefügt");
  } catch (err){
    // ...
  }
}


    // ----------------------------
    // CSV EXPORT
    // ----------------------------
function exportCSV() {
  if(!canRemove){
    showNotification("Nur Admin kann CSV exportieren","error");
    return;
  }
  if(!allEvents.length){
    showNotification("Keine Events zum Exportieren","info");
    return;
  }
  let csv = "Datum;Event;Theke;Garderobe;Tür;Kasse;Schichtleitung\n";
  
  allEvents.forEach(ev=>{
    const dObj= new Date(ev.datum);
    const dd= String(dObj.getDate()).padStart(2,'0');
    const mm= String(dObj.getMonth()+1).padStart(2,'0');
    const yyyy= dObj.getFullYear();
    const dateStr= dd+"."+mm+"."+yyyy;

    csv+= dateStr + ";" + ev.name + ";";

    // Theke
    const arrTheke= ev.mitarbeiterByRole && ev.mitarbeiterByRole.Theke ? ev.mitarbeiterByRole.Theke : [];
    csv += arrTheke.join(",") + ";";

    // Garderobe
    const arrGard= ev.mitarbeiterByRole && ev.mitarbeiterByRole.Garderobe ? ev.mitarbeiterByRole.Garderobe : [];
    csv += arrGard.join(",") + ";";

    // Tür
    const arrTuer= ev.mitarbeiterByRole && ev.mitarbeiterByRole.Tür ? ev.mitarbeiterByRole.Tür : [];
    csv += arrTuer.join(",") + ";";

    // Kasse
    const arrKasse= ev.mitarbeiterByRole && ev.mitarbeiterByRole.Kasse ? ev.mitarbeiterByRole.Kasse : [];
    csv += arrKasse.join(",") + ";";

    // Schichtleitung
    const arrSL= ev.mitarbeiterByRole && ev.mitarbeiterByRole.Schichtleitung ? ev.mitarbeiterByRole.Schichtleitung : [];
    csv += arrSL.join(",") + "\n";
  });

      // download
      const blob= new Blob([csv], {type:'text/csv;charset=utf-8;'});
      const url= URL.createObjectURL(blob);
      const a= document.createElement('a');
      a.href= url;
      a.setAttribute('download','verfuegbarkeiten.csv');
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
    }

    // ----------------------------
    // EVENTS RENDERN (Mitarbeiter sieht nur sich selbst)
    // ----------------------------
    function renderEvents(events){
      const container= document.getElementById('eventContainer');
      container.innerHTML='';

      events.forEach(ev=>{
        const dObj= new Date(ev.datum);
        const dStr= dObj.toLocaleDateString('de-DE',{day:'2-digit',month:'2-digit',year:'numeric',weekday:'long'});

        const div= document.createElement('div');
        div.className='event';

        div.innerHTML= `
          <h3>${ev.name}</h3>
          ${canRemove ? `<button class="remove-event" onclick="removeEvent('${ev.id}')">x</button>` : ''}
          <p><strong>${dStr}</strong> • Start: ${ev.startzeit||''} Uhr</p>
        `;

        // availability
        const availabilityDiv= document.createElement('div');
        availabilityDiv.className='availability';

        (ev.mitarbeiter||[]).forEach(name=>{
          // Nur Admin sieht alle, Normaler Nutzer sieht nur name==loggedInUser
          if(!canRemove && name.toLowerCase() !== (loggedInUser||"").toLowerCase()) {
            return; 
          }
          // Erstellen
          const nameSpan= document.createElement('span');
          nameSpan.className='name-item';
          nameSpan.textContent= name;
          if(canRemove){
            const btn= document.createElement('button');
            btn.className='remove';
            btn.textContent='x';
            btn.onclick= ()=> removeName(ev.id,name);
            nameSpan.appendChild(btn);
          }
          availabilityDiv.appendChild(nameSpan);
        });
        div.appendChild(availabilityDiv);

        // "Ich kann arbeiten!" button
        const confirmBtn= document.createElement('button');
        confirmBtn.style.width='auto';
        confirmBtn.style.display='inline-block';
        confirmBtn.textContent="Ich kann arbeiten!";
        confirmBtn.onclick= ()=> confirmForEvent(ev.id);
        div.appendChild(confirmBtn);

        // Link "Details" (statt Kommentare)
        const link= document.createElement('a');
        link.textContent="Details"; 
        link.href=`eventDetails.html?id=${ev.id}`;
        link.style.position='absolute';
        link.style.bottom='10px';
        link.style.right='10px';
        link.style.fontSize='0.9em';
        link.style.color='#007bff';
        link.style.textDecoration='none';
        div.appendChild(link);

        container.appendChild(div);
      });
    }

    // ----------------------------
    // FUNKTION: confirmForEvent => Bestätigungs-Dialog
    // ----------------------------
    async function confirmForEvent(eventId){
      if(!loggedInUser){
        showNotification("Bitte einloggen",'error');
        return;
      }
      // Abfrage
      if(!confirm("Bitte bestätige, dass du arbeiten kannst.")) {
        // User abgebrochen -> mach nichts
        return;
      }
      try {
        const ref= doc(db,"events", eventId);
        await updateDoc(ref, {
          mitarbeiter: arrayUnion(loggedInUser)
        });
        showNotification("Du hast dich angemeldet.");
      } catch(err){
        console.error("Fehler beim Bestätigen", err);
        showNotification("Fehler: "+ err.message,'error');
      }
    }

    // ----------------------------
    // removeName, removeEvent etc.
    // ----------------------------
    async function removeName(eventId, name){
      if(!canRemove)return;
      try {
        const ref= doc(db,"events", eventId);
        await updateDoc(ref, {
          mitarbeiter: arrayRemove(name)
        });
        showNotification("Name entfernt",'info');
      }catch(err){
        showNotification("Fehler: "+err.message,'error');
      }
    }

    async function removeEvent(eventId){
      if(!canRemove)return;
      if(!confirm("Möchtest du dieses Event löschen?")) return;
      try {
        await deleteDoc(doc(db,"events", eventId));
        showNotification("Event gelöscht",'info');
      }catch(err){
        showNotification("Fehler beim Löschen: "+err.message,'error');
      }
    }

    // Admin: Neues Event
    async function addEvent(){ 
      // ...
    }

    // etc.

    // ----------------------------
    // ADMIN-INIT
    // ----------------------------
    async function initAdminSection(){
      await loadAllUsers();
      listenToEvents();
    }

    // ----------------------------
    // AUTH
    // ----------------------------
    async function loginWithEmail(){ /* dein Code */ }
    async function registerWithEmail(){
      const nameVal = document.getElementById('usernameRegister').value.trim();
      const emailVal= document.getElementById('emailRegister').value.trim();
      const pwVal   = document.getElementById('passwordRegister').value;
      if(!nameVal||!emailVal||!pwVal){
        showNotification("Bitte Benutzername,E-Mail,Passwort",'error');
        return;
      }
      try{
        const cred= await createUserWithEmailAndPassword(auth, emailVal, pwVal);
        await updateProfile(cred.user,{ displayName: nameVal });
        await addDoc(collection(db,"users"),{
          datum: eventDate,
  name: eventNameVal,
  startzeit: eventTime,
  // neu:
  mitarbeiterByRole: {
    Theke: [],
    Garderobe: [],
    Tür: [],
    Kasse: [],
    Schichtleitung: []
        });
        showNotification("Registrierung erfolgreich. Bitte einloggen",'success');
      }catch(err){
        showNotification("Registrierung fehlgeschlagen: "+err.message,'error');
      }
    }
    async function logout(){ /* ... */ }

    // UI
    function updateUIAfterLogin(){
      document.getElementById('authSection').style.display='none';
      document.getElementById('eventForm').style.display= canRemove ? 'block':'none';
      const userLabel= document.getElementById('welcomeUser');
      userLabel.textContent='Willkommen, '+loggedInUser+'!';
      userLabel.style.display='block';
      document.getElementById('logoutButton').style.display='inline-block';

      if(canRemove){
        document.getElementById('adminSection').style.display='block';
        document.getElementById('manageUsersBtn').style.display='inline-block';
        initAdminSection();
      } else {
        document.getElementById('adminSection').style.display='none';
        document.getElementById('manageUsersBtn').style.display='none';
        listenToEvents(); // Nur events, kein admin
      }
    }
    function updateUIAfterLogout(){
      document.getElementById('authSection').style.display='block';
      document.getElementById('eventForm').style.display='none';
      document.getElementById('welcomeUser').style.display='none';
      document.getElementById('logoutButton').style.display='none';
      document.getElementById('adminSection').style.display='none';
      document.getElementById('eventContainer').innerHTML='';
    }

    function toggleOtherEvent(){
      const val = document.getElementById('eventName').value;
      document.getElementById('otherEventContainer').style.display= (val==='sonstige') ? 'block':'none';
    }

    // onAuthStateChanged
    onAuthStateChanged(auth, (user)=>{
      if(user){
        loggedInUser= user.displayName||user.email;
        canRemove= (user.email.toLowerCase()==='moritz@goethebunker.de');
        updateUIAfterLogin();
      } else {
        loggedInUser=null;
        canRemove=false;
        updateUIAfterLogout();
      }
    });

    document.addEventListener('DOMContentLoaded', ()=>{
      setCurrentDate();

      document.getElementById('loginButton').addEventListener('click', loginWithEmail);
      document.getElementById('registerButton').addEventListener('click', registerWithEmail);
      document.getElementById('logoutButton').addEventListener('click', logout);

      document.getElementById('manageUsersBtn').addEventListener('click', ()=>{
        window.location.href='adminUsers.html';
      });
    });

    // Für Inline
    window.removeEvent       = removeEvent;
    window.removeName        = removeName;
    window.confirmForEvent   = confirmForEvent;
    window.addEvent          = addEvent;
    window.toggleOtherEvent  = toggleOtherEvent;
    window.exportCSV         = exportCSV;
  </script>
</body>
</html>
